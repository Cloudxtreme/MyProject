Test_FirewallRule_Allow_AnyToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Delete Firewall rule"
    Tags: "Edge,Firewall"
    TestName: "firewall Data path 1"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_AnyToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Pass"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_AnyToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall:
                '[1]':
                    enabled: "true"
                    default_policy:
                       action: "deny"
                       logging_enabled: "true"
                    global_config:
                        tcp_pick_ongoing_conn: "true"
                        tcp_allow_outofwindow_packets: "true"
                        tcp_send_resets_for_closed_servicerouter_ports: "true"
                        tcp_timeout_close: 30
                        tcp_timeout_established: 3600
                        tcp_timeout_open: 30
                        icmp_timeout: 10
                        icmp6_timeout: 10
                        drop_invalid_traffic: "true"
                        log_invalid_traffic: "true"
                        udp_timeout: 120
                        ip_generic_timeout: 120
                    rules:
                        - name: "Auto-Allow_AnyToAnyForAnyService"
                          rule_type: "USER"
                          enabled: "true"
                          logging_enabled: "true"
                          action: "accept"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

Test_FirewallRule_Allow_AnyToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Delete Firewall rule"
    Tags: "Edge,Firewall"
    TestName: "firewall Data path 2"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_AnyToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_AnyToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall:
                '[1]':
                    enabled: "true"
                    default_policy:
                       action: "deny"
                       logging_enabled: "true"
                    global_config:
                        tcp_pick_ongoing_conn: "true"
                        tcp_allow_outofwindow_packets: "true"
                        tcp_send_resets_for_closed_servicerouter_ports: "true"
                        tcp_timeout_close: 30
                        tcp_timeout_established: 3600
                        tcp_timeout_open: 30
                        icmp_timeout: 10
                        icmp6_timeout: 10
                        drop_invalid_traffic: "true"
                        log_invalid_traffic: "true"
                        udp_timeout: 120
                        ip_generic_timeout: 120
                    rules:
                        - name: "Auto-Allow_AnyToVM2IPForAnyService"
                          rule_type: "USER"
                          enabled: "true"
                          logging_enabled: "true"
                          action: "accept"
                          destination:
                              ip4add:
                                  - value: "vm.[2].vnic.[1]"
                                    type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Delete Firewall rule"
    Tags: "Edge,Firewall"
    TestName: "firewall Data path 3"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_VM1IPToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall:
                '[1]':
                    enabled: "true"
                    default_policy:
                       action: "deny"
                       logging_enabled: "true"
                    global_config:
                        tcp_pick_ongoing_conn: "true"
                        tcp_allow_outofwindow_packets: "true"
                        tcp_send_resets_for_closed_servicerouter_ports: "true"
                        tcp_timeout_close: 30
                        tcp_timeout_established: 3600
                        tcp_timeout_open: 30
                        icmp_timeout: 10
                        icmp6_timeout: 10
                        drop_invalid_traffic: "true"
                        log_invalid_traffic: "true"
                        udp_timeout: 120
                        ip_generic_timeout: 120
                    rules:
                        - name: "Auto-Allow_VM1IPToAnyForAnyService"
                          rule_type: "USER"
                          enabled: "true"
                          logging_enabled: "true"
                          action: "accept"
                          source:
                              ip4add:
                                  - value: "vm.[1].vnic.[1]"
                                    type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Delete Firewall rule"
    Tags: "Edge,Firewall"
    TestName: "firewall Data path 4"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_VM1IPToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall:
                '[1]':
                    enabled: "true"
                    default_policy:
                       action: "deny"
                       logging_enabled: "true"
                    global_config:
                        tcp_pick_ongoing_conn: "true"
                        tcp_allow_outofwindow_packets: "true"
                        tcp_send_resets_for_closed_servicerouter_ports: "true"
                        tcp_timeout_close: 30
                        tcp_timeout_established: 3600
                        tcp_timeout_open: 30
                        icmp_timeout: 10
                        icmp6_timeout: 10
                        drop_invalid_traffic: "true"
                        log_invalid_traffic: "true"
                        udp_timeout: 120
                        ip_generic_timeout: 120
                    rules:
                        - name: "Auto-Allow_VM1IPToVM2IPForAnyService"
                          rule_type: "USER"
                          enabled: "true"
                          logging_enabled: "true"
                          action: "accept"
                          source:
                              ip4add:
                                  - value: "vm.[1].vnic.[1]"
                                    type: "ipv4address"
                          destination:
                              ip4add:
                                  - value: "vm.[2].vnic.[1]"
                                    type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_GetFirewallRuleById:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Delete Firewall rule"
    Tags: "Edge,Firewall"
    TestName: "GET for ruleID"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["AppendFirewallRule"]
            - ["ReadFirewallRule"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        AppendFirewallRule:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        ReadFirewallRule:
            Type: "Router"
            TestRouter: 'vsm.[1].gateway.[1].firewall_rules.[1]'
            verifyendpointattributes:
                "name[?]equal_to": "Append-AllowFromVM1toVM2"
                "ruleType[?]equal_to": "user"
                "enabled[?]equal_to": "true"
                "loggingEnabled[?]equal_to": "true"
                "action[?]equal_to": "accept"
                "source[?]contains":
                    "ipAddress[?]equal_to": "172.16.0.2"
                "destination[?]contains":
                    "ipAddress[?]equal_to": "10.10.10.2"

Test_FirewallRule_Allow_Cluster1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToAnyForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 1"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToAnyForAnyService"]
            - ["PingVM1Cluster1toVM2Cluster2_Pass"]
            - ["PingVM2Cluster2toVM1Cluster1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-Cluster1ToAnyForAnyService"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                            source_exclude: "false"
                            sources:
                                - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                  type: "Cluster"

        PingVM1Cluster1toVM2Cluster2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2Cluster2toVM1Cluster1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_Cluster1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToCluster2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 2"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-Cluster1ToCluster2ForAnyService"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToDVPG2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 3"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-Cluster1ToDVPG2ForAnyService"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToDC2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 4"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-Cluster1ToDC2ForAnyService"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToVM2IPForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 5"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule for Cluster1ToVM2NetworkForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 6"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-Cluster1ToVM2NetworkForAnyService"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Cluster1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 8"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM2"]
            - ["FirewallRule_Allow_Cluster1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

#Test_FirewallRule_Allow_Cluster1ToLS2ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule for Allow_Cluster1ToLS2ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 9"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM1_VM2"]
#            - ["VIF_ATTACHMENT_VM4"]
#            - ["Poweron_VM1_VM2"]
#            - ["PoweronVM4"]
#            - ["ConfigureIP_VM1_VM2"]
#            - ["ConfigureVM4Vnic1IP_9_9_10_2"]
#            - ["AddRoute_VM1_VM2"]
#            - ["AddRouteVM4_VM1"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_Cluster1ToLS2ForAnyService"]
#            - ["PingVM1toVM4_Pass"]
#            - ["PingVM4toVM1_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM1", "PoweroffVM2", "PoweroffVM4"]
#            - ["DeleteVnic1_VM1_VM2"]
#            - ["DeleteVM4Vnic1"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_Cluster1ToLS2ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-Cluster1ToVM2NetworkForAnyService"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
#                                 type: "Cluster"
#                       destination:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[2].virtualwire.[1]"
#
#        PingVM1toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[1].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM1_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[1].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 11"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToVM2ForAnyService"]
            - ["PingVM1Cluster1toVM2Cluster2_Pass"]
            - ["PingVM2Cluster2toVM1Cluster1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                            sources:
                                - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                  type: "Cluster"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"

        PingVM1Cluster1toVM2Cluster2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2Cluster2toVM1Cluster1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Cluster1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 12"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Cluster1ToEdgeInterface2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_Cluster1ToEdgeInterface2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: 'vc.[1].datacenter.[1].cluster.[1]'
                                 type: "Cluster"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 13"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 14"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 15"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 16"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "DataCenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 17"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 18"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule DVPG1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 20"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_DVPG1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 23"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DVPG1ToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           destinations:
                               - value: "vm.[2]"
                                 type: "VirtualMachine"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DVPG1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 24"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DVPG1ToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DVPG1ToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].dvportgroup.[1]"
                                 type: "DistributedVirtualPortGroup"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_DC1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 27"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 28"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 29"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 30"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 31"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_DC1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 32"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule DC1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 34"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"
        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 37"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_DC1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 38"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_DC1ToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_DC1ToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - value: "vc.[1].datacenter.[1]"
                                 type: "Datacenter"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 39"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_VM1IPToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 40"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1IPToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_VM1IPToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 41"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1IPToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"
        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule VM1IPToDC2ForAnyService" 
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 42"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_VM1IPToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule VM1IPToVM2IPForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 43"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]

        FirewallRule_Allow_VM1IPToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 44"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1IPToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_VM1IPToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 49"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1IPToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1IPToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 50"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1IPToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1IPToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ip4add:
                               - value: "vm.[1].vnic.[1]"
                                 type: "ipv4address"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 51"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 52"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 53"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 54"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 55"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 56"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule VM1NetworkToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 58"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 61"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"
        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1NetworkToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 62"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1NetworkToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1NetworkToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           ipv4address: "172.16.0.0/24"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToAnyForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 75"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToCluster2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 76"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToDVPG2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 77"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToDC2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 78"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToVM2IPForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 79"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToVM2NetworkForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 80"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 82"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["CreateSecurityGroupWithVM2"]
            - ["FirewallRule_Allow_SG1VM1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToVM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 85"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           destinations:
                               - value: "vm.[2]"
                                 type: "VirtualMachine"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_SG1VM1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule SG1VM1ToEdgeUplink1ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 86"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM1"]
            - ["FirewallRule_Allow_SG1VM1ToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_SG1VM1ToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[1]"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

#Test_FirewallRule_Allow_LogicalSwitch1ToAnyForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToAnyForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 87"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToAnyForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToAnyForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM1toVM2"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToCluster2ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToCluster2ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 88"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToCluster2ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToCluster2ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM1toVM2"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
#                                 type: "Cluster"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToDVPG4ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToDVPG4ForAnyService" 
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 89"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToDVPG4ForAnyService"]
#            - ["PingVM3toVM2_Pass"]
#            - ["PingVM3toVM4_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToDVPG4ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM2"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - value: "vc.[1].dvportgroup.[4]"
#                                 type: "DistributedVirtualPortGroup"
#
#        PingVM3toVM2_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[2].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM3toVM4_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToDC2ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToDC2ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 90"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToDC2ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToDC2ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - value: "vc.[1].datacenter.[2]"
#                                 type: "Datacenter"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToVM4IPForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToVM4IPForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 91"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToVM4IPForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToVM4IPForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           ip4add:
#                               - value: "vm.[4].vnic.[1]"
#                                 type: "ipv4address"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToVM4NetworkForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToVM4NetworkForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 92"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToVM4NetworkForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToVM4NetworkForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           ipv4address: "9.9.10.0/24"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToSG4VM4ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToSG4VM4ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 94"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["CreateSecurityGroupWithVM4"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToSG4VM4ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToSG4VM4ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - type: 'SecurityGroup'
#                                 value: "vsm.[1].securitygroup.[4]"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToLogicalSwitch2ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToLogicalSwitch2ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 95"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToLogicalSwitch2ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToLogicalSwitch2ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[2].virtualwire.[1]"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToVM4ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToVM4ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 97"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToVM4ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToVM4ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           destinations:
#                               - type: 'VirtualMachine'
#                                 value: "vm.[4]"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"
#
#Test_FirewallRule_Allow_LogicalSwitch1ToEdgeUplink2ForAnyService:
#    Category: "Edge_Firewall"
#    Component: "Firewall"
#    ExpectedResult: "PASS"
#    Summary: "Add and Verify Firewall-Allow rule LogicalSwitch1ToEdgeUplink2ForAnyService"
#    Tags: "Edge,Firewall"
#    TestName: "VC container different combination data path 98"
#    Version: "2"
#    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
#    WORKLOADS:
#        Sequence:
#            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
#            - ["VifAttachment_VM3_VM4"]
#            - ["PoweronVM3", "PoweronVM4"]
#            - ["ConfigureIP_VM3_VM4"]
#            - ["AddRouteVM3_VM4", "AddRouteVM4_VM3"]
#            - ["EnableECMP"]
#            - ["AddStaticRoutes"]
#            - ["AllowFirewallExtGateway"]
#            - ["FirewallRule_Allow_LogicalSwitch1ToEdgeUplink2ForAnyService"]
#            - ["PingVM3toVM4_Pass"]
#            - ["PingVM4toVM3_Fail"]
#        ExitSequence:
#            - ["DefaultFirewallRuleOnEdges"]
#            - ["DELETE_STATICROUTE_ALL_EDGES"]
#            - ["PoweroffVM3", "PoweroffVM4"]
#            - ["DeleteVnic1_VM3_VM4"]
#            - ["DeleteGateway1Interfaces"]
#            - ["DeleteGateway2Interfaces"]
#
#
#        FirewallRule_Allow_LogicalSwitch1ToEdgeUplink2ForAnyService:
#            Type: "Router"
#            TestRouter: "vsm.[1].gateway.[1]"
#            firewall_rules:
#                '[1]':
#                    rules:
#                       name: "Append-AllowFromVM3toVM4"
#                       rule_type: "USER"
#                       enabled: "true"
#                       logging_enabled: "true"
#                       action: "accept"
#                       source:
#                           sources:
#                               - type: 'LogicalSwitch'
#                                 value: "vsm.[1].networkscope.[1].virtualwire.[1]"
#                       destination:
#                           vnic_group_id: "vnic-index-4"
#
#        PingVM3toVM4_Pass:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[3].vnic.[1]"
#            SupportAdapter: "vm.[4].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "PASS"
#
#        PingVM4toVM3_Fail:
#            Type: "Traffic"
#            ToolName: "Ping"
#            TestAdapter: "vm.[4].vnic.[1]"
#            SupportAdapter: "vm.[3].vnic.[1]"
#            TestDuration: "2"
#            connectivitytest: '0'
#            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 111"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 112"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_VM1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 113"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_VM1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 114"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 115"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 116"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule VM1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 117"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM2"]
            - ["FirewallRule_Allow_VM1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_VM1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 120"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_VM1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 121"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_VM1ToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_VM1ToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           sources:
                               - type: 'VirtualMachine'
                                 value: "vm.[1]"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToAnyForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 122"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToAnyForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToAnyForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToCluster2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 123"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToCluster2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToCluster2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           destinations:
                               - value: 'vc.[1].datacenter.[2].cluster.[1]'
                                 type: "Cluster"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToDVPG2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 124"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToDVPG2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToDVPG2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           destinations:
                               - value: "vc.[1].dvportgroup.[4]"
                                 type: "DistributedVirtualPortGroup"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToDC2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 125"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToDC2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToDC2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           destinations:
                               - value: "vc.[1].datacenter.[2]"
                                 type: "Datacenter"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToVM2IPForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 126"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToVM2IPForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToVM2IPForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           ip4add:
                               - value: "vm.[2].vnic.[1]"
                                 type: "ipv4address"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToVM2NetworkForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 127"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToVM2NetworkForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToVM2NetworkForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           ipv4address: "9.9.9.0/24"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToSG2VM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule Internal1ToSG2VM2ForAnyService"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 128"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["CreateSecurityGroupWithVM2"]
            - ["FirewallRule_Allow_Internal1ToSG2VM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DeleteSecurityGroups"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToSG2VM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           destinations:
                               - type: 'SecurityGroup'
                                 value: "vsm.[1].securitygroup.[2]"
        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"


Test_FirewallRule_Allow_Internal1ToVM2ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 131"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToVM2ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToVM2ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           destinations:
                               - type: 'VirtualMachine'
                                 value: "vm.[2]"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"

Test_FirewallRule_Allow_Internal1ToEdgeUplink1ForAnyService:
    Category: "Edge_Firewall"
    Component: "Firewall"
    ExpectedResult: "PASS"
    Summary: "Add and Verify Firewall-Allow rule"
    Tags: "Edge,Firewall"
    TestName: "VC container different combination data path 132"
    Version: "2"
    TestbedSpec: *OneVSM_OneVC_OneDC_OneVDS_TwoHosts_OneCluster
    WORKLOADS:
        Sequence:
            - ["CreateGateway1Interfaces","CreateGateway2Interfaces"]
            - ["VifAttachment_VM1_VM2"]
            - ["Poweron_VM1_VM2"]
            - ["ConfigureIP_VM1_VM2"]
            - ["AddRoute_VM1_VM2"]
            - ["EnableECMP"]
            - ["AddStaticRoutes"]
            - ["AllowFirewallExtGateway"]
            - ["FirewallRule_Allow_Internal1ToEdgeUplink1ForAnyService"]
            - ["PingVM1toVM2_Pass"]
            - ["PingVM2toVM1_Fail"]
        ExitSequence:
            - ["DefaultFirewallRuleOnEdges"]
            - ["DELETE_STATICROUTE_ALL_EDGES"]
            - ["PoweroffVM1", "PoweroffVM2"]
            - ["DeleteVnic1_VM1_VM2"]
            - ["DeleteGateway1Interfaces"]
            - ["DeleteGateway2Interfaces"]


        FirewallRule_Allow_Internal1ToEdgeUplink1ForAnyService:
            Type: "Router"
            TestRouter: "vsm.[1].gateway.[1]"
            firewall_rules:
                '[1]':
                    rules:
                       name: "Append-AllowFromVM1toVM2"
                       rule_type: "USER"
                       enabled: "true"
                       logging_enabled: "true"
                       action: "accept"
                       source:
                           vnic_group_id: "vnic-index-1"
                       destination:
                           vnic_group_id: "vnic-index-2"

        PingVM1toVM2_Pass:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[1].vnic.[1]"
            SupportAdapter: "vm.[2].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "PASS"

        PingVM2toVM1_Fail:
            Type: "Traffic"
            ToolName: "Ping"
            TestAdapter: "vm.[2].vnic.[1]"
            SupportAdapter: "vm.[1].vnic.[1]"
            TestDuration: "2"
            connectivitytest: '0'
            Expectedresult: "FAIL"
